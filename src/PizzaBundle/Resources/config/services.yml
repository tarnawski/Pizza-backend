services:
  pizza.type.factory:
    class: PizzaBundle\Model\TypeFactory

  pizza.customer.factory:
    class: PizzaBundle\Model\CustomerFactory

  pizza.order.factory:
    class: PizzaBundle\Model\OrderFactory

  pizza.item.factory:
    class: PizzaBundle\Model\ItemFactory
    arguments:
      entityManager: "@doctrine.orm.entity_manager"

  pizza.customer.repository:
      class: Doctrine\ORM\EntityRepository
      factory: [@doctrine.orm.entity_manager, getRepository]
      arguments:
        - PizzaBundle\Entity\Customer

  pizza.order.repository:
      class: Doctrine\ORM\EntityRepository
      factory: [@doctrine.orm.entity_manager, getRepository]
      arguments:
        - PizzaBundle\Entity\Order

  promo.code.type.validate:
      class: PizzaBundle\Validator\Constraints\PromoCodeTypeValidator
      tags:
        -  { name: validator.constraint_validator, alias: promo_code_type_validate }

  promo.code.unique.validate:
      class: PizzaBundle\Validator\Constraints\PromoCodeUniqueValidator
      arguments:
            entityManager: "@doctrine.orm.entity_manager"
            security: @security.token_storage
      tags:
        -  { name: validator.constraint_validator, alias: promo_code_unique_validate }

  pizza.promo_code.business:
    class: PizzaBundle\Model\PromoCodeBusiness
    arguments:
      entityManager: "@doctrine.orm.entity_manager"